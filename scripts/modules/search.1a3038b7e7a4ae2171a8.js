webpackJsonp([4],{202:function(e,t,a){"use strict";function n(e,t){return Object(r.a)(e,t)}var r=a(50);t.a=n},206:function(e,t,a){"use strict";function n(e){return"function"==typeof e?e:u.a}function r(e,t){return(Object(l.a)(e)?i.a:o.a)(e,c(t))}var i=a(207),o=a(49),u=a(21),c=n,l=a(5);t.a=r},207:function(e,t,a){"use strict";function n(e,t){for(var a=-1,n=null==e?0:e.length;++a<n&&!1!==t(e[a],a,e););return e}t.a=n},209:function(e,t,a){"use strict";function n(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}t.a=n},223:function(e,t){e.exports={label:"FiltersSummary-qihw02rE"}},225:function(e,t){e.exports={container:"FacetsGroup-1rE0RbSG"}},232:function(e,t){e.exports={container:"SearchResult-BC1quGiz",list:"SearchResult-2J9rvEwf"}},233:function(e,t){e.exports={container:"SearchPagination-18Q0cOcH",page:"SearchPagination-a3oZiNlf",disabled:"SearchPagination-3_bWlhyy",break:"SearchPagination-2bSilu2g",pageLink:"SearchPagination-1UwN844_",active:"SearchPagination-2N2emten"}},234:function(e,t){e.exports={results:"SearchResults-Hv3B_jdB",result:"SearchResults-1Qx6fsA_",loader:"SearchResults-3c4P9TdQ",paginationWrapper:"SearchResults-1HNoDkbc"}},235:function(e,t){e.exports={container:"SearchPage-p63y_zUY",search:"SearchPage-lggXKdsm"}},236:function(e,t,a){function n(e){return a(r(e))}function r(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./en.json":237,"./fr.json":238};n.keys=function(){return Object.keys(i)},n.resolve=r,e.exports=n,n.id=236},237:function(e,t){e.exports={FiltersSummary:{activeFilters:"Active filter",activeFilters_plural:"Active filters",noFilters:"No filters"},SearchPage:{documentTitle:"Search dataset"},SearchPagination:{previous:"Previous",next:"Next"},SearchResult:{keywords:"Keyword",keywords_plural:"Keywords",organizations:"Organization",organizations_plural:"Organizations"},SearchResultsCount:{results:"{{count}} dataset found.",results_plural:"{{count}} datasets found.",noResults:"No datasets found."}}},238:function(e,t){e.exports={FiltersSummary:{activeFilters:"Filtre actif",activeFilters_plural:"Filtres actifs",noFilters:"Aucun filtre"},SearchPage:{documentTitle:"Recherche jeu de données"},SearchPagination:{previous:"Précédent",next:"Suivant"},SearchResult:{keywords:"Mot-clé",keywords_plural:"Mots-clés",organizations:"Organisation",organizations_plural:"Organisations"},SearchResultsCount:{results:"{{count}} jeu de données trouvé.",results_plural:"{{count}} jeux de données trouvé.",noResults:"Aucun jeu de données trouvé."}}},370:function(e,t,a){"use strict";function n(e,t){return!!(null==e?0:e.length)&&Object(k.a)(e,t,0)>-1}function r(e,t,a){for(var n=-1,r=null==e?0:e.length;++n<r;)if(a(t,e[n]))return!0;return!1}function i(){}function o(e,t,a){var n=-1,r=_,i=e.length,o=!0,u=[],c=u;if(a)o=!1,r=F;else if(i>=L){var l=t?null:A(e);if(l)return Object(Q.a)(l);o=!1,r=x.a,c=new w.a}else c=t?[]:u;e:for(;++n<i;){var s=e[n],f=t?t(s):s;if(s=a||0!==s?s:0,o&&f===f){for(var p=c.length;p--;)if(c[p]===f)continue e;t&&c.push(f),u.push(s)}else r(c,f,a)||(c!==u&&c.push(f),u.push(s))}return u}function u(e){return Object(U.a)(e)&&Object(z.a)(e)}function c(e,t){var a;return Object(ce.a)(e,function(e,n,r){return!(a=t(e,n,r))}),!!a}function l(e,t,a){var n=Object(se.a)(e)?oe.a:le;return a&&Object(fe.a)(e,t,a)&&(t=void 0),n(e,Object(ue.a)(t,3))}function s(e){return de[e]||e}function f(e,t){return pe(e,t)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function y(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}Object.defineProperty(t,"__esModule",{value:!0});var b,E=a(204),S=a(46),O=a(45),j=a(202),C=a(99),P=a(100),w=a(108),k=a(215),_=n,F=r,x=a(110),R=a(117),N=i,Q=a(91),T=R.a&&1/Object(Q.a)(new R.a([,-0]))[1]==1/0?function(e){return new R.a(e)}:N,A=T,L=200,q=o,z=a(18),U=a(11),H=u,I=a(209),X=Object(P.a)(function(e){var t=Object(I.a)(e);return t="function"==typeof t?t:void 0,q(Object(C.a)(e,1,H,!0),void 0,t)}),D=X,G=a(0),M=(a(1),a(3)),W=a(26),B=a(88),K=a.n(B),J=a(13),V=a(93),Y=a(210),Z=a(223),$=a.n(Z),ee=function(e){var t=e.filters,a=e.removeFilter,n=e.t;return G.default.createElement("div",null,G.default.createElement("div",{className:$.a.label},t.length?n("FiltersSummary.activeFilters",{count:t.length}):n("FiltersSummary.noFilters")),t.map(function(e,t){return G.default.createElement(Y.a,{key:t,detail:!0,remove:!0,filter:e,onClick:function(e){return a(e)}})}))},te=Object(M.translate)("Search")(ee),ae=te,ne=a(119),re=a(206),ie=a(211),oe=a(109),ue=a(47),ce=a(49),le=c,se=a(5),fe=a(123),pe=l,de={availability:"téléchargeable",dgvPublication:"publié sur data.gouv.fr",distributionFormat:"format de distribution",keyword:"mot-clé",metadataType:"type de metadonnée",opendata:"donnée ouverte",organization:"organisation",representationType:"type géographique",type:"type",catalog:"catalogue",yes:"oui",no:"non","not-determined":"non déterminé",other:"autre",unknown:"inconnu",none:"aucun"},he=a(225),ge=function(e){var t=e.type,a=e.facets,n=e.filters,r=e.addFilter,i=a.map(function(e){return f(n,{name:t,value:e.value})});return-1===i.indexOf(!1)?null:G.default.createElement("div",{className:he.container},G.default.createElement("h4",null,s(t)),a.map(function(e,a){return G.default.createElement(ie.a,{key:a,name:t,value:e.value,count:e.count,isActive:i[a],addFilter:r})}))},ve=ge,me=function(e){function t(){return p(this,t),d(this,e.apply(this,arguments))}return h(t,e),t.prototype.render=function(){var e=this.props,t=e.facets,a=e.filters,n=e.addFilter;if(!t)return G.default.createElement("div",null);var r=[];Object(re.a)(t,function(e,t){var a={type:t,value:e};r.push(a)});var i=Object(ne.a)(r,"type");return G.default.createElement("div",null,i.map(function(e){return G.default.createElement(ve,{key:e.type,type:e.type,facets:e.value,filters:a,addFilter:n})}))},t}(G.default.PureComponent),ye=me,be=function(e){var t=e.count,a=e.t;return G.default.createElement("div",null,t?a("SearchResultsCount.results",{count:t}):a("SearchResultsCount.noResults"))},Ee=Object(M.translate)("Search")(be),Se=Ee,Oe=a(8),je=a(216),Ce=a(232),Pe=a.n(Ce),we=function(e){var t=e.dataset,a=e.addFilter,n=e.t;return G.default.createElement("div",{className:Pe.a.container},G.default.createElement("h4",null,G.default.createElement(Oe.Link,{to:"/datasets/"+t.recordId},t.metadata.title)),t.metadata.description&&G.default.createElement(je.a,{markdown:t.metadata.description}),G.default.createElement("h5",null,n("SearchResult.keywords",{context:t.metadata.keywords.length})),G.default.createElement("div",{className:Pe.a.list},t.metadata.keywords.map(function(e,t){return G.default.createElement(Y.a,{key:t,onClick:a,filter:{value:e,name:"keyword"}})})),G.default.createElement("h5",null,n("SearchResult.organizations",{context:t.organizations.length})),G.default.createElement("div",{className:Pe.a.list},t.organizations.map(function(e,t){return G.default.createElement(Y.a,{key:t,onClick:a,filter:{value:e,name:"organization"}})})))},ke=Object(M.translate)("Search")(we),_e=ke,Fe=a(125),xe=a.n(Fe),Re=a(233),Ne=a.n(Re),Qe=function(e){var t=e.t,a=e.page,n=e.pageCount,r=e.onPageChange,i=e.previousLabel,o=void 0===i?t("SearchPagination.previous"):i,u=e.nextLabel,c=void 0===u?t("SearchPagination.next"):u,l=e.breakLabel,s=void 0===l?"…":l,f=a-1||0;return G.default.createElement(xe.a,{previousLabel:o,nextLabel:c,breakLabel:s,pageCount:n,initialPage:f,marginPagesDisplayed:2,pageRangeDisplayed:5,onPageChange:r,containerClassName:Ne.a.container,pageClassName:Ne.a.page,breakClassName:Ne.a.break,pageLinkClassName:Ne.a.pageLink,previousClassName:Ne.a.page,previousLinkClassName:Ne.a.pageLink,nextClassName:Ne.a.page,nextLinkClassName:Ne.a.pageLink,activeClassName:Ne.a.active})},Te=Object(M.translate)("Search")(Qe),Ae=Te,Le=a(234),qe=a.n(Le),ze=function(e){var t=e.count,a=e.page,n=e.query,r=e.results,i=e.facets,o=e.addFilter,u=e.changePage,c=r?Math.ceil(t/n.limit):0;return G.default.createElement("div",null,G.default.createElement(Se,{count:t}),t>0&&G.default.createElement("div",{className:qe.a.results},G.default.createElement("div",{className:qe.a.result},r.map(function(e){return G.default.createElement(_e,{key:e._id,dataset:e,addFilter:o})})),G.default.createElement(ye,{facets:i,filters:n.facets,addFilter:o})),c>1&&G.default.createElement("div",{className:qe.a.paginationWrapper},G.default.createElement(Ae,{page:a,pageCount:c,onPageChange:u})))},Ue=ze,He=Ue,Ie=a(235),Xe=a.n(Ie),De=function(e){function t(){var a,n,r;g(this,t);for(var i=arguments.length,o=Array(i),u=0;u<i;u++)o[u]=arguments[u];return a=n=v(this,e.call.apply(e,[this].concat(o))),n.redirectToQuery=function(e){n.props.history.push({pathname:"/search",search:K.a.stringify(e)})},n.addFilter=function(e){var t=n.props,a=t.location,r=t.updateQuery,i=t.search;n.redirectToQuery(r(a.search,{filters:D(i.parsedQuery.filters,[e],j.a)}))},n.removeFilter=function(e){var t=n.props,a=t.location,r=t.updateQuery,i=t.search;n.redirectToQuery(r(a.search,{filters:i.parsedQuery.filters.filter(function(t){return t.name!==e.name||t.value!==e.value})}))},n.updateQuery=function(e){var t=n.props,a=t.location,r=t.updateQuery;n.redirectToQuery(r(a.search,{q:e}))},n.changePage=function(e){var t=e.selected,a=n.props,r=a.location,i=a.updateQuery,o=a.search,u=t+1;o.parsedQuery.page!==u&&n.redirectToQuery(i(r.search,{page:u}))},r=a,v(n,r)}return m(t,e),t.prototype.componentDidMount=function(){var e=this.props,t=e.location;(0,e.execute)(t.search)},t.prototype.componentWillReceiveProps=function(e){var t=e.location,a=this.props.execute;t!==this.props.location&&a(t.search)},t.prototype.render=function(){var e=this.props,t=e.search,a=e.t;return G.default.createElement("div",{className:Xe.a.container},G.default.createElement(W.Helmet,{title:a("SearchPage.documentTitle")}),G.default.createElement("div",{className:Xe.a.search},G.default.createElement(V.a,{defaultValue:t.parsedQuery.textInput,onSearch:this.updateQuery,hasButton:!0}),G.default.createElement(ae,{filters:t.parsedQuery.filters,removeFilter:this.removeFilter})),G.default.createElement(J.a,{isLoading:t.pending,error:t.error},G.default.createElement(He,{page:t.parsedQuery.page,query:t.search.query,count:t.search.count,results:t.search.results,facets:t.search.facets,addFilter:this.addFilter,changePage:this.changePage})))},t}(G.default.PureComponent),Ge=Object(M.translate)("Search")(De),Me=Ge,We=a(89),Be=["q","page","offset","limit"],Ke=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.startsWith("?")&&(e=e.substring(1)),K.a.parse(e)},Je=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[],a=Ke(e);return Object.entries(a).forEach(function(e){var a=e[0],n=e[1];Be.includes(a)||(Array.isArray(n)?n.forEach(function(e){t.push({name:a,value:e})}):t.push({name:a,value:n}))}),{textInput:a.q,page:parseInt(a.page,10)||1,filters:t}},Ve=function(e){return e.reduce(function(e,t){return(e[t.name]=e[t.name]||[]).push(t.value),e},{})},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Ke(e),n=a.q,r=(a.page,y(a,["q","page"])),i="q"in t?t.q:n,o=t.page||1;return Object.assign({},i?{q:i}:{},o&&o>1?{page:o}:{},t.filters?Ve(t.filters):r)},Ze=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return function(a){var n=Je(e);a({type:"SEARCH_EXECUTE_PENDING",parsedQuery:n});var r=Ve(n.filters);return Object(We.b)("https://inspire.data.gouv.fr/api/geogw/records?"+K.a.stringify(Object.assign({},r,{q:n.textInput,offset:(n.page-1)*t,limit:t}))).then(function(e){a({type:"SEARCH_EXECUTE_SUCCESS",payload:e})}).catch(function(e){a({type:"SEARCH_EXECUTE_FAILURE",error:e})})}},$e=Object(O.connect)(function(e){return{search:e.search,updateQuery:Ye}},{execute:Ze})(Me),et={pending:!1,error:!1,parsedQuery:{filters:[],page:1},search:{facets:{},query:{facets:[]},results:[],count:0}},tt=(b={},b.SEARCH_EXECUTE_PENDING=function(e,t){return Object.assign({},e,{pending:!0,error:!1,parsedQuery:t.parsedQuery})},b.SEARCH_EXECUTE_SUCCESS=function(e,t){return Object.assign({},e,{pending:!1,search:t.payload,error:!1})},b.SEARCH_EXECUTE_FAILURE=function(e,t){return Object.assign({},e,{pending:!1,error:t.error})},b),at=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments[1],a=tt[t.type];return a?a(e,t):e};t.default=Object(E.a)("search",at)(Object(S.a)("Search",function(e){return a(236)("./"+e+".json")})($e))}});
//# sourceMappingURL=search.1a3038b7e7a4ae2171a8.js.map